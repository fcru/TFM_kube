import sys
import os

from transformations import *

if __name__ == "__main__":

    consolidation_process()

    tmb_path = f"hdfs://hadooop-hadoop-hdfs-nn:9000/trusted-zone/TMB"
    print("Processing TMB directory..")
    process_json_files_to_mongodb(tmb_path)
    print("Processed")

    print("Processing bcn_data directory..")
    bcn_path = f"hdfs://hadooop-hadoop-hdfs-nn:9000/trusted-zone/bcn_data"
    union_df(f"{bcn_path}/bcn_bike_lanes.json", f"{bcn_path}/bcn_no_motorized_vehicles.json", f"{bcn_path}/bike_lanes_unified_no_motor.json")
    union_df(f"{bcn_path}/commercial_census.json", f"{bcn_path}/Large_shopping_centers.json",
             f"{bcn_path}/all_commercials.json")
    process_json_files_to_mongodb(bcn_path)
    print("Processed")

    print("Consolidate Informacio..")
    write_informacio_to_mongo()
    print("Processed")

